WITH sum_conso AS (
    SELECT c.id_produit AS produit, c.quantite_commande AS quantite, c.id_personne_consommateur as consommateur,
    p.nom_produit,
    p.id_categorie AS categorie,
    p.id_produit,
pers.nom_personne AS nom,
pers.prenom_personne AS prenom 
FROM commandes AS c JOIN produits AS p ON c.id_produit = p.id_produit JOIN personnes as pers ON pers.id_personne = c.id_personne_consommateur),

SELECTION AS (
SELECT nom,prenom, nom_produit, COUNT(nom_produit) as qtte FROM sum_conso GROUP BY consommateur, produit LIMIT 100)

SELECT nom,prenom, MAX(qtte) FROM SELECTION GROUP BY nom,prenom